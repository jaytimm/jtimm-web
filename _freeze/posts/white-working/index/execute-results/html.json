{
  "hash": "34a8fb42a65f2f4de690033d6941083f",
  "result": {
    "markdown": "---\ntitle: \"race & education in america\"\n## description: \"\"\ndate: \"2022-06-30\"\ncategories: [demographics]\n  \nformat:\n  html:\n    toc: true\n    toc-depth: 2\n    number-sections: true\n    \nbibliography: /home/jtimm/pCloudDrive/GitHub/jtimm_web/biblio.bib\nimage: preview.png\n---\n\n\n\n![](preview2.png){width=100% .preview-image}\n\n\n---\n\n\n> White working class formalized in US Census terms: Population 25 years & older who (1) identify as both White & non-Hispanic and (2) have not obtained a Bachelor’s degree (or higher). Per Table C15002: Sex by educational attainment for the population 25 years and over.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhite_ed_vars <- c(white_m_bach = 'C15002H_006',\n                   white_w_bach = 'C15002H_011',\n                   white_pop = 'C15002H_001',\n\n                   all_w_xbach = 'C15002_016',\n                   all_w_xgrad = 'C15002_017',\n                   all_m_xbach = 'C15002_008',\n                   all_m_xgrad = 'C15002_009',\n                   all_pop = 'C15002_001')\n```\n:::\n\n\n\nCategories include:\n\n* White & non-Hispanic with college degree,\n\n* White & non-Hispanic without college degree,\n\n* Non-White and/or Hispanic with college degree, and\n\n* Non-White and/or Hispanic college degree.\n\n\nNote: The “and/or Hispanic” piece is slightly confusing here. For most people, Hispanic = Brown = Race; from this perspective, ethnicity (as distinct from race) is not a meaningful distinction. We include it here because it is included in the census.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nstates_sf <- tigris::states(cb = TRUE) |>\n  rename(state_code = STATEFP, state_abbrev = STUSPS)\n\nstates <- states_sf |>\n  data.frame() |>\n  select(state_code, state_abbrev)\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhite_ed <- tidycensus::get_acs(geography = 'congressional district',\n                            variables = white_ed_vars,\n                            year = 2019,\n                            survey = 'acs1') |>\n  select(-moe) |>\n  tidyr::spread(key = variable, value = estimate) |>\n\n  mutate(white_college =\n           white_m_bach +\n           white_w_bach,\n         white_working =\n           white_pop -\n           white_college,\n         \n         non_white_college =\n           all_m_xbach +\n           all_w_xbach +\n           all_m_xgrad +\n           all_w_xgrad -\n           white_college,\n         non_white_working =\n           all_pop -\n           white_pop -\n           non_white_college) |>\n\n  select(GEOID, white_college:non_white_working) |>\n  \n  tidyr::gather(-GEOID, key = 'group', value = 'estimate') |>\n  group_by(GEOID) |>\n  mutate(per = round(estimate/ sum(estimate) * 100, 1)) |>\n  ungroup() |>\n  mutate(state_code = substr(GEOID, 1, 2),\n         district_code = substr(GEOID, 3, 4))  |>\n  left_join(states, by = c('state_code')) |>\n  select(GEOID, state_code, state_abbrev, \n         district_code, group, per, estimate)\n```\n:::\n\n\n\n\n\n\nRace-work class distributions\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nset.seed(99)\nsamp_n <- sample(unique(white_ed$GEOID), 12)\n\nwhite_ed |>\n  filter(GEOID %in% samp_n) |>\n  ggplot(aes(area = per,\n             fill = group,\n             label = gsub('_', '-', toupper(group)),\n             subgroup = group)) +\n  treemapify::geom_treemap(alpha=.65)+\n  treemapify::geom_treemap_subgroup_border(color = 'white') +\n  treemapify::geom_treemap_text(colour = \"black\", \n                                place = \"topleft\", \n                                reflow = T,\n                                size = 8) +\n  \n  scale_fill_manual(values = c('#8faabe', '#1a476f', \n                               '#dae2ba', '#55752f')) +\n  theme_minimal() +\n  facet_wrap(~paste0(state_abbrev, '-', district_code)) +\n  theme(legend.position = \"none\") + \n  labs(title = \"Race-work class distributions\",\n       caption = 'Source: ACS 1-Year estimates, 2019, Table C15002')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n## map\n\n::: {.cell}\n\n```{.r .cell-code}\ncds_sf <- tigris::congressional_districts(cb = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRetrieving data for the year 2020\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |==                                                                    |   4%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |================                                                      |  24%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |=======================                                               |  34%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |============================                                          |  41%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |==============================                                        |  44%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |===================================                                   |  51%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |============================================                          |  64%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |===================================================                   |  74%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |==========================================================            |  84%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |=================================================================     |  94%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntops <- white_ed |>\n  group_by(GEOID) |>\n  slice(which.max(estimate)) |>\n  ungroup() |>\n  filter(!state_code %in% c('60', '66', '69', '72',\n                            '78', '02', '15'))\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncds_sf |> inner_join(tops) |>\n  \n  ggplot() + \n  geom_sf(aes(fill = group), \n          color = 'grey',\n          size = .25,\n          alpha=.65) + \n  \n  scale_fill_manual(values = c('#8faabe', \n                               '#1a476f', \n                               '#dae2ba', \n                               '#55752f')) +\n  theme_minimal() +\n  theme(axis.title.x=element_blank(),\n        axis.text.x=element_blank(),\n        axis.title.y=element_blank(),\n        axis.text.y=element_blank(),\n        legend.position = 'bottom') # \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}